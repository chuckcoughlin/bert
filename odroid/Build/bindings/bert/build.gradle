/*
 * This gradle file builds and installs the "Bert" java code.
 */
plugins {
	id 'java'
	id 'application'
}


mainClassName = 'chuckcoughlin.bert.main.Bert'
sourceCompatibility = '1.11'
targetCompatibility = '1.11'

sourceSets {
	main {
		java {
			srcDirs = ['../../../Bert/src']
		}
	}
}

compileJava {
    doFirst {
        options.compilerArgs = [
            '--module-path', classpath.asPath,
        ]
        classpath = files()
    }
}


dependencies {
	compile project(':logging')
    compile fileTree(include: ['*.jar'], dir: '../../../Archive/mods')
}

jar{
	doFirst {
		from configurations.compile.collect{ zipTree it }
		manifest.attributes "Main-Class": "chuckcoughlin.bert.main.Bert" 
	}
}
/*
 * Copy the jar file to the robot
 * The default working directory is: Build/bindings/bert
 * commandLine "rsync -a bert.jar bert:/usr/local/robot"
 */
task install( type:Exec) {
	project.logger.info( "Installing ...")
	workingDir "build/libs"
	args "-a","bert.jar","bert:/usr/local/robot"
	executable "rsync"
}
